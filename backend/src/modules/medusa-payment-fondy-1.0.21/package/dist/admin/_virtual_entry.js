var Dt=Object.defineProperty,wt=Object.defineProperties;var pt=Object.getOwnPropertyDescriptors;var ye=Object.getOwnPropertySymbols;var We=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable;var $e=(e,r,t)=>r in e?Dt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,m=(e,r)=>{for(var t in r||(r={}))We.call(r,t)&&$e(e,t,r[t]);if(ye)for(var t of ye(r))ze.call(r,t)&&$e(e,t,r[t]);return e},j=(e,r)=>wt(e,pt(r));var he=(e,r)=>{var t={};for(var i in e)We.call(e,i)&&r.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&ye)for(var i of ye(e))r.indexOf(i)<0&&ze.call(e,i)&&(t[i]=e[i]);return t};import{jsx as D,jsxs as B,Fragment as ge}from"react/jsx-runtime";import{FocusModal as me,Button as Ke,Input as xt,useToggleState as Et,Container as kt,Heading as Vt,DropdownMenu as ve}from"@medusajs/ui";import{EllipsisHorizontal as St,PencilSquare as Ct}from"@medusajs/icons";import G,{useState as Nt,useEffect as Tt}from"react";import{useAdminUpdateProduct as Ot,useAdminCustomQuery as Bt}from"medusa-react";var ne=e=>e.type==="checkbox",re=e=>e instanceof Date,N=e=>e==null;const Qe=e=>typeof e=="object";var S=e=>!N(e)&&!Array.isArray(e)&&Qe(e)&&!re(e),Lt=e=>S(e)&&e.target?ne(e.target)?e.target.checked:e.target.value:e,Rt=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Mt=(e,r)=>e.has(Rt(r)),ae=e=>Array.isArray(e)?e.filter(Boolean):[],V=e=>e===void 0,d=(e,r,t)=>{if(!r||!S(e))return t;const i=ae(r.split(/[,[\].]+?/)).reduce((l,a)=>N(l)?l:l[a],e);return V(i)||i===e?V(e[r])?t:e[r]:i};const Ge={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},$={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},J={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};G.createContext(null);var Pt=(e,r,t,i=!0)=>{const l={defaultValues:r._defaultValues};for(const a in e)Object.defineProperty(l,a,{get:()=>{const h=a;return r._proxyFormState[h]!==$.all&&(r._proxyFormState[h]=!i||$.all),t&&(t[h]=!0),e[h]}});return l},M=e=>S(e)&&!Object.keys(e).length,Ut=(e,r,t)=>{const a=e,{name:i}=a,l=he(a,["name"]);return M(l)||Object.keys(l).length>=Object.keys(r).length||Object.keys(l).find(h=>r[h]===(!t||$.all))},Ve=e=>Array.isArray(e)?e:[e];function It(e){const r=G.useRef(e);r.current=e,G.useEffect(()=>{const t=!e.disabled&&r.current.subject.subscribe({next:r.current.callback});return()=>{t&&t.unsubscribe()}},[e.disabled])}var W=e=>typeof e=="string",qt=(e,r,t,i)=>{const l=Array.isArray(e);return W(e)?(i&&r.watch.add(e),d(t,e)):l?e.map(a=>(i&&r.watch.add(a),d(t,a))):(i&&(r.watchAll=!0),t)},be=e=>typeof e=="function",Je=e=>{for(const r in e)if(be(e[r]))return!0;return!1},Ht=(e,r,t,i,l)=>r?j(m({},t[e]),{types:j(m({},t[e]&&t[e].types?t[e].types:{}),{[i]:l||!0})}):{},Se=e=>/^\w*$/.test(e),Xe=e=>ae(e.replace(/["|']|\]/g,"").split(/\.|\[/));function w(e,r,t){let i=-1;const l=Se(r)?[r]:Xe(r),a=l.length,h=a-1;for(;++i<a;){const g=l[i];let F=t;if(i!==h){const p=e[g];F=S(p)||Array.isArray(p)?p:isNaN(+l[i+1])?{}:[]}e[g]=F,e=e[g]}return e}const Ce=(e,r,t)=>{for(const l of t||Object.keys(e)){const a=d(e,l);if(a){const i=a,{_f:h}=i,g=he(i,["_f"]);if(h&&r(h.name)){if(h.ref.focus){h.ref.focus();break}else if(h.refs&&h.refs[0].focus){h.refs[0].focus();break}}else S(g)&&Ce(g,r)}}};var Ye=(e,r,t)=>!t&&(r.watchAll||r.watch.has(e)||[...r.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length)))),jt=(e,r,t)=>{const i=ae(d(e,t));return w(i,"root",r[t]),w(e,t,i),e},_e=e=>typeof e=="boolean",Ne=e=>e.type==="file",Fe=e=>W(e)||G.isValidElement(e),Te=e=>e.type==="radio",Ae=e=>e instanceof RegExp;const Ze={value:!1,isValid:!1},et={value:!0,isValid:!0};var tt=e=>{if(Array.isArray(e)){if(e.length>1){const r=e.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:r,isValid:!!r.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!V(e[0].attributes.value)?V(e[0].value)||e[0].value===""?et:{value:e[0].value,isValid:!0}:et:Ze}return Ze};const rt={isValid:!1,value:null};var st=e=>Array.isArray(e)?e.reduce((r,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:r,rt):rt;function ut(e,r,t="validate"){if(Fe(e)||Array.isArray(e)&&e.every(Fe)||_e(e)&&!e)return{type:t,message:Fe(e)?e:"",ref:r}}var se=e=>S(e)&&!Ae(e)?e:{value:e,message:""},it=async(e,r,t,i,l)=>{const{ref:a,refs:h,required:g,maxLength:F,minLength:p,min:L,max:A,pattern:b,validate:P,name:O,valueAsNumber:U,mount:pe,disabled:X}=e._f;if(!pe||X)return{};const z=h?h[0]:a,K=v=>{i&&z.reportValidity&&(z.setCustomValidity(_e(v)?"":v||" "),z.reportValidity())},E={},ie=Te(a),ce=ne(a),Y=ie||ce,ee=(U||Ne(a))&&!a.value||r===""||Array.isArray(r)&&!r.length,I=Ht.bind(null,O,t,E),fe=(v,_,k,C=J.maxLength,q=J.minLength)=>{const R=v?_:k;E[O]=m({type:v?C:q,message:R,ref:a},I(v?C:q,R))};if(l?!Array.isArray(r)||!r.length:g&&(!Y&&(ee||N(r))||_e(r)&&!r||ce&&!tt(h).isValid||ie&&!st(h).isValid)){const{value:v,message:_}=Fe(g)?{value:!!g,message:g}:se(g);if(v&&(E[O]=m({type:J.required,message:_,ref:z},I(J.required,_)),!t))return K(_),E}if(!ee&&(!N(L)||!N(A))){let v,_;const k=se(A),C=se(L);if(!N(r)&&!isNaN(r)){const q=a.valueAsNumber||r&&+r;N(k.value)||(v=q>k.value),N(C.value)||(_=q<C.value)}else{const q=a.valueAsDate||new Date(r),R=de=>new Date(new Date().toDateString()+" "+de),le=a.type=="time",te=a.type=="week";W(k.value)&&r&&(v=le?R(r)>R(k.value):te?r>k.value:q>new Date(k.value)),W(C.value)&&r&&(_=le?R(r)<R(C.value):te?r<C.value:q<new Date(C.value))}if((v||_)&&(fe(!!v,k.message,C.message,J.max,J.min),!t))return K(E[O].message),E}if((F||p)&&!ee&&(W(r)||l&&Array.isArray(r))){const v=se(F),_=se(p),k=!N(v.value)&&r.length>v.value,C=!N(_.value)&&r.length<_.value;if((k||C)&&(fe(k,v.message,_.message),!t))return K(E[O].message),E}if(b&&!ee&&W(r)){const{value:v,message:_}=se(b);if(Ae(v)&&!r.match(v)&&(E[O]=m({type:J.pattern,message:_,ref:a},I(J.pattern,_)),!t))return K(_),E}if(P){if(be(P)){const v=await P(r),_=ut(v,z);if(_&&(E[O]=m(m({},_),I(J.validate,_.message)),!t))return K(_.message),E}else if(S(P)){let v={};for(const _ in P){if(!M(v)&&!t)break;const k=ut(await P[_](r),z,_);k&&(v=m(m({},k),I(_,k.message)),K(k.message),t&&(E[O]=v))}if(!M(v)&&(E[O]=m({ref:z},v),!t))return E}}return K(!0),E},$t=e=>{const r=e.constructor&&e.constructor.prototype;return S(r)&&r.hasOwnProperty("isPrototypeOf")},Oe=typeof window!="undefined"&&typeof window.HTMLElement!="undefined"&&typeof document!="undefined";function Z(e){let r;const t=Array.isArray(e);if(e instanceof Date)r=new Date(e);else if(e instanceof Set)r=new Set(e);else if(!(Oe&&(e instanceof Blob||e instanceof FileList))&&(t||S(e)))if(r=t?[]:{},!Array.isArray(e)&&!$t(e))r=e;else for(const i in e)r[i]=Z(e[i]);else return e;return r}var lt=e=>({isOnSubmit:!e||e===$.onSubmit,isOnBlur:e===$.onBlur,isOnChange:e===$.onChange,isOnAll:e===$.all,isOnTouch:e===$.onTouched});function Wt(e,r){const t=r.slice(0,-1).length;let i=0;for(;i<t;)e=V(e)?i++:e[r[i++]];return e}function zt(e){for(const r in e)if(!V(e[r]))return!1;return!0}function T(e,r){const t=Se(r)?[r]:Xe(r),i=t.length==1?e:Wt(e,t),l=t[t.length-1];let a;i&&delete i[l];for(let h=0;h<t.slice(0,-1).length;h++){let g=-1,F;const p=t.slice(0,-(h+1)),L=p.length-1;for(h>0&&(a=e);++g<p.length;){const A=p[g];F=F?F[A]:e[A],L===g&&(S(F)&&M(F)||Array.isArray(F)&&zt(F))&&(a?delete a[A]:delete e[A]),a=F}}return e}function Be(){let e=[];return{get observers(){return e},next:l=>{for(const a of e)a.next(l)},subscribe:l=>(e.push(l),{unsubscribe:()=>{e=e.filter(a=>a!==l)}}),unsubscribe:()=>{e=[]}}}var De=e=>N(e)||!Qe(e);function ue(e,r){if(De(e)||De(r))return e===r;if(re(e)&&re(r))return e.getTime()===r.getTime();const t=Object.keys(e),i=Object.keys(r);if(t.length!==i.length)return!1;for(const l of t){const a=e[l];if(!i.includes(l))return!1;if(l!=="ref"){const h=r[l];if(re(a)&&re(h)||S(a)&&S(h)||Array.isArray(a)&&Array.isArray(h)?!ue(a,h):a!==h)return!1}}return!0}var Le=e=>{const r=e?e.ownerDocument:0,t=r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement;return e instanceof t},nt=e=>e.type==="select-multiple",Kt=e=>Te(e)||ne(e),Re=e=>Le(e)&&e.isConnected;function we(e,r={}){const t=Array.isArray(e);if(S(e)||t)for(const i in e)Array.isArray(e[i])||S(e[i])&&!Je(e[i])?(r[i]=Array.isArray(e[i])?[]:{},we(e[i],r[i])):N(e[i])||(r[i]=!0);return r}function at(e,r,t){const i=Array.isArray(e);if(S(e)||i)for(const l in e)Array.isArray(e[l])||S(e[l])&&!Je(e[l])?V(r)||De(t[l])?t[l]=Array.isArray(e[l])?we(e[l],[]):m({},we(e[l])):at(e[l],N(r)?{}:r[l],t[l]):t[l]=!ue(e[l],r[l]);return t}var Me=(e,r)=>at(e,r,we(r)),ot=(e,{valueAsNumber:r,valueAsDate:t,setValueAs:i})=>V(e)?e:r?e===""?NaN:e&&+e:t&&W(e)?new Date(e):i?i(e):e;function Pe(e){const r=e.ref;if(!(e.refs?e.refs.every(t=>t.disabled):r.disabled))return Ne(r)?r.files:Te(r)?st(e.refs).value:nt(r)?[...r.selectedOptions].map(({value:t})=>t):ne(r)?tt(e.refs).value:ot(V(r.value)?e.ref.value:r.value,e)}var Qt=(e,r,t,i)=>{const l={};for(const a of e){const h=d(r,a);h&&w(l,a,h._f)}return{criteriaMode:t,names:[...e],fields:l,shouldUseNativeValidation:i}},oe=e=>V(e)?void 0:Ae(e)?e.source:S(e)?Ae(e.value)?e.value.source:e.value:e,Gt=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function ct(e,r,t){const i=d(e,t);if(i||Se(t))return{error:i,name:t};const l=t.split(".");for(;l.length;){const a=l.join("."),h=d(r,a),g=d(e,a);if(h&&!Array.isArray(h)&&t!==a)return{name:t};if(g&&g.type)return{name:a,error:g};l.pop()}return{name:t}}var Jt=(e,r,t,i,l)=>l.isOnAll?!1:!t&&l.isOnTouch?!(r||e):(t?i.isOnBlur:l.isOnBlur)?!e:(t?i.isOnChange:l.isOnChange)?e:!0,Xt=(e,r)=>!ae(d(e,r)).length&&T(e,r);const Yt={mode:$.onSubmit,reValidateMode:$.onChange,shouldFocusError:!0};function Zt(e={}){let r=m(m({},Yt),e),t={submitCount:0,isDirty:!1,isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},i={},l=Z(r.defaultValues)||{},a=r.shouldUnregister?{}:Z(l),h={action:!1,mount:!1,watch:!1},g={mount:new Set,unMount:new Set,array:new Set,watch:new Set},F,p=0,L={};const A={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},b={watch:Be(),array:Be(),state:Be()},P=lt(r.mode),O=lt(r.reValidateMode),U=r.criteriaMode===$.all,pe=s=>u=>{clearTimeout(p),p=window.setTimeout(s,u)},X=async s=>{let u=!1;return A.isValid&&(u=r.resolver?M((await Y()).errors):await I(i,!0),!s&&u!==t.isValid&&(t.isValid=u,b.state.next({isValid:u}))),u},z=(s,u=[],n,c,y=!0,o=!0)=>{if(c&&n){if(h.action=!0,o&&Array.isArray(d(i,s))){const f=n(d(i,s),c.argA,c.argB);y&&w(i,s,f)}if(A.errors&&o&&Array.isArray(d(t.errors,s))){const f=n(d(t.errors,s),c.argA,c.argB);y&&w(t.errors,s,f),Xt(t.errors,s)}if(A.touchedFields&&o&&Array.isArray(d(t.touchedFields,s))){const f=n(d(t.touchedFields,s),c.argA,c.argB);y&&w(t.touchedFields,s,f)}A.dirtyFields&&(t.dirtyFields=Me(l,a)),b.state.next({isDirty:v(s,u),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else w(a,s,u)},K=(s,u)=>{w(t.errors,s,u),b.state.next({errors:t.errors})},E=(s,u,n,c)=>{const y=d(i,s);if(y){const o=d(a,s,V(n)?d(l,s):n);V(o)||c&&c.defaultChecked||u?w(a,s,u?o:Pe(y._f)):C(s,o),h.mount&&X()}},ie=(s,u,n,c,y)=>{let o=!1;const f={name:s},x=d(t.touchedFields,s);if(A.isDirty){const H=t.isDirty;t.isDirty=f.isDirty=v(),o=H!==f.isDirty}if(A.dirtyFields&&(!n||c)){const H=d(t.dirtyFields,s);ue(d(l,s),u)?T(t.dirtyFields,s):w(t.dirtyFields,s,!0),f.dirtyFields=t.dirtyFields,o=o||H!==d(t.dirtyFields,s)}return n&&!x&&(w(t.touchedFields,s,n),f.touchedFields=t.touchedFields,o=o||A.touchedFields&&x!==n),o&&y&&b.state.next(f),o?f:{}},ce=async(s,u,n,c)=>{const y=d(t.errors,s),o=A.isValid&&t.isValid!==u;if(e.delayError&&n?(F=pe(()=>K(s,n)),F(e.delayError)):(clearTimeout(p),F=null,n?w(t.errors,s,n):T(t.errors,s)),(n?!ue(y,n):y)||!M(c)||o){const f=j(m(m({},c),o?{isValid:u}:{}),{errors:t.errors,name:s});t=m(m({},t),f),b.state.next(f)}L[s]--,A.isValidating&&!Object.values(L).some(f=>f)&&(b.state.next({isValidating:!1}),L={})},Y=async s=>r.resolver?await r.resolver(m({},a),r.context,Qt(s||g.mount,i,r.criteriaMode,r.shouldUseNativeValidation)):{},ee=async s=>{const{errors:u}=await Y();if(s)for(const n of s){const c=d(u,n);c?w(t.errors,n,c):T(t.errors,n)}else t.errors=u;return u},I=async(s,u,n={valid:!0})=>{for(const y in s){const o=s[y];if(o){const c=o,{_f:f}=c,x=he(c,["_f"]);if(f){const H=g.array.has(f.name),Q=await it(o,d(a,f.name),U,r.shouldUseNativeValidation,H);if(Q[f.name]&&(n.valid=!1,u))break;!u&&(d(Q,f.name)?H?jt(t.errors,Q,f.name):w(t.errors,f.name,Q[f.name]):T(t.errors,f.name))}x&&await I(x,u,n)}}return n.valid},fe=()=>{for(const s of g.unMount){const u=d(i,s);u&&(u._f.refs?u._f.refs.every(n=>!Re(n)):!Re(u._f.ref))&&xe(s)}g.unMount=new Set},v=(s,u)=>(s&&u&&w(a,s,u),!ue(de(),l)),_=(s,u,n)=>{const c=m({},h.mount?a:V(u)?l:W(s)?{[s]:u}:u);return qt(s,g,c,n)},k=s=>ae(d(h.mount?a:l,s,e.shouldUnregister?d(l,s,[]):[])),C=(s,u,n={})=>{const c=d(i,s);let y=u;if(c){const o=c._f;o&&(!o.disabled&&w(a,s,ot(u,o)),y=Oe&&Le(o.ref)&&N(u)?"":u,nt(o.ref)?[...o.ref.options].forEach(f=>f.selected=y.includes(f.value)):o.refs?ne(o.ref)?o.refs.length>1?o.refs.forEach(f=>(!f.defaultChecked||!f.disabled)&&(f.checked=Array.isArray(y)?!!y.find(x=>x===f.value):y===f.value)):o.refs[0]&&(o.refs[0].checked=!!y):o.refs.forEach(f=>f.checked=f.value===y):Ne(o.ref)?o.ref.value="":(o.ref.value=y,o.ref.type||b.watch.next({name:s})))}(n.shouldDirty||n.shouldTouch)&&ie(s,y,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&te(s)},q=(s,u,n)=>{for(const c in u){const y=u[c],o=`${s}.${c}`,f=d(i,o);(g.array.has(s)||!De(y)||f&&!f._f)&&!re(y)?q(o,y,n):C(o,y,n)}},R=(s,u,n={})=>{const c=d(i,s),y=g.array.has(s),o=Z(u);w(a,s,o),y?(b.array.next({name:s,values:a}),(A.isDirty||A.dirtyFields)&&n.shouldDirty&&(t.dirtyFields=Me(l,a),b.state.next({name:s,dirtyFields:t.dirtyFields,isDirty:v(s,o)}))):c&&!c._f&&!N(o)?q(s,o,n):C(s,o,n),Ye(s,g)&&b.state.next({}),b.watch.next({name:s})},le=async s=>{const u=s.target;let n=u.name;const c=d(i,n);if(c){let y,o;const f=u.type?Pe(c._f):Lt(s),x=s.type===Ge.BLUR||s.type===Ge.FOCUS_OUT,H=!Gt(c._f)&&!r.resolver&&!d(t.errors,n)&&!c._f.deps||Jt(x,d(t.touchedFields,n),t.isSubmitted,O,P),Q=Ye(n,g,x);w(a,n,f),x?(c._f.onBlur&&c._f.onBlur(s),F&&F(0)):c._f.onChange&&c._f.onChange(s);const ke=ie(n,f,x,!1),Ft=!M(ke)||Q;if(!x&&b.watch.next({name:n,type:s.type}),H)return Ft&&b.state.next(m({name:n},Q?{}:ke));if(!x&&Q&&b.state.next({}),L[n]=(L[n],1),b.state.next({isValidating:!0}),r.resolver){const{errors:He}=await Y([n]),At=ct(t.errors,i,n),je=ct(He,i,At.name||n);y=je.error,n=je.name,o=M(He)}else y=(await it(c,d(a,n),U,r.shouldUseNativeValidation))[n],o=await X(!0);c._f.deps&&te(c._f.deps),ce(n,o,y,ke)}},te=async(s,u={})=>{let n,c;const y=Ve(s);if(b.state.next({isValidating:!0}),r.resolver){const o=await ee(V(s)?s:y);n=M(o),c=s?!y.some(f=>d(o,f)):n}else s?(c=(await Promise.all(y.map(async o=>{const f=d(i,o);return await I(f&&f._f?{[o]:f}:f)}))).every(Boolean),!(!c&&!t.isValid)&&X()):c=n=await I(i);return b.state.next(j(m(m({},!W(s)||A.isValid&&n!==t.isValid?{}:{name:s}),r.resolver||!s?{isValid:n}:{}),{errors:t.errors,isValidating:!1})),u.shouldFocus&&!c&&Ce(i,o=>o&&d(t.errors,o),s?y:g.mount),c},de=s=>{const u=m(m({},l),h.mount?a:{});return V(s)?u:W(s)?d(u,s):s.map(n=>d(u,n))},Ie=(s,u)=>({invalid:!!d((u||t).errors,s),isDirty:!!d((u||t).dirtyFields,s),isTouched:!!d((u||t).touchedFields,s),error:d((u||t).errors,s)}),ht=s=>{s?Ve(s).forEach(u=>T(t.errors,u)):t.errors={},b.state.next({errors:t.errors})},gt=(s,u,n)=>{const c=(d(i,s,{_f:{}})._f||{}).ref;w(t.errors,s,j(m({},u),{ref:c})),b.state.next({name:s,errors:t.errors,isValid:!1}),n&&n.shouldFocus&&c&&c.focus&&c.focus()},mt=(s,u)=>be(s)?b.watch.subscribe({next:n=>s(_(void 0,u),n)}):_(s,u,!0),xe=(s,u={})=>{for(const n of s?Ve(s):g.mount)g.mount.delete(n),g.array.delete(n),d(i,n)&&(u.keepValue||(T(i,n),T(a,n)),!u.keepError&&T(t.errors,n),!u.keepDirty&&T(t.dirtyFields,n),!u.keepTouched&&T(t.touchedFields,n),!r.shouldUnregister&&!u.keepDefaultValue&&T(l,n));b.watch.next({}),b.state.next(m(m({},t),u.keepDirty?{isDirty:v()}:{})),!u.keepIsValid&&X()},Ee=(s,u={})=>{let n=d(i,s);const c=_e(u.disabled);return w(i,s,j(m({},n||{}),{_f:m(j(m({},n&&n._f?n._f:{ref:{name:s}}),{name:s,mount:!0}),u)})),g.mount.add(s),n?c&&w(a,s,u.disabled?void 0:d(a,s,Pe(n._f))):E(s,!0,u.value),j(m(m({},c?{disabled:u.disabled}:{}),r.shouldUseNativeValidation?{required:!!u.required,min:oe(u.min),max:oe(u.max),minLength:oe(u.minLength),maxLength:oe(u.maxLength),pattern:oe(u.pattern)}:{}),{name:s,onChange:le,onBlur:le,ref:y=>{if(y){Ee(s,u),n=d(i,s);const o=V(y.value)&&y.querySelectorAll&&y.querySelectorAll("input,select,textarea")[0]||y,f=Kt(o),x=n._f.refs||[];if(f?x.find(H=>H===o):o===n._f.ref)return;w(i,s,{_f:m(m({},n._f),f?{refs:[...x.filter(Re),o,...Array.isArray(d(l,s))?[{}]:[]],ref:{type:o.type,name:s}}:{ref:o})}),E(s,!1,void 0,o)}else n=d(i,s,{}),n._f&&(n._f.mount=!1),(r.shouldUnregister||u.shouldUnregister)&&!(Mt(g.array,s)&&h.action)&&g.unMount.add(s)}})},qe=()=>r.shouldFocusError&&Ce(i,s=>s&&d(t.errors,s),g.mount),vt=(s,u)=>async n=>{n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let c=!0,y=Z(a);b.state.next({isSubmitting:!0});try{if(r.resolver){const{errors:o,values:f}=await Y();t.errors=o,y=f}else await I(i);M(t.errors)?(b.state.next({errors:{},isSubmitting:!0}),await s(y,n)):(u&&await u(m({},t.errors),n),qe())}catch(o){throw c=!1,o}finally{t.isSubmitted=!0,b.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:M(t.errors)&&c,submitCount:t.submitCount+1,errors:t.errors})}},bt=(s,u={})=>{d(i,s)&&(V(u.defaultValue)?R(s,d(l,s)):(R(s,u.defaultValue),w(l,s,u.defaultValue)),u.keepTouched||T(t.touchedFields,s),u.keepDirty||(T(t.dirtyFields,s),t.isDirty=u.defaultValue?v(s,d(l,s)):v()),u.keepError||(T(t.errors,s),A.isValid&&X()),b.state.next(m({},t)))},_t=(s,u={})=>{const n=s||l,c=Z(n),y=s&&!M(s)?c:l;if(u.keepDefaultValues||(l=n),!u.keepValues){if(u.keepDirtyValues)for(const o of g.mount)d(t.dirtyFields,o)?w(y,o,d(a,o)):R(o,d(y,o));else{if(Oe&&V(s))for(const o of g.mount){const f=d(i,o);if(f&&f._f){const x=Array.isArray(f._f.refs)?f._f.refs[0]:f._f.ref;try{if(Le(x)){x.closest("form").reset();break}}catch(H){}}}i={}}a=e.shouldUnregister?u.keepDefaultValues?Z(l):{}:c,b.array.next({values:y}),b.watch.next({values:y})}g={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!A.isValid||!!u.keepIsValid,h.watch=!!e.shouldUnregister,b.state.next({submitCount:u.keepSubmitCount?t.submitCount:0,isDirty:u.keepDirty||u.keepDirtyValues?t.isDirty:!!(u.keepDefaultValues&&!ue(s,l)),isSubmitted:u.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:u.keepDirty||u.keepDirtyValues?t.dirtyFields:u.keepDefaultValues&&s?Me(l,s):{},touchedFields:u.keepTouched?t.touchedFields:{},errors:u.keepErrors?t.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})};return{control:{register:Ee,unregister:xe,getFieldState:Ie,_executeSchema:Y,_focusError:qe,_getWatch:_,_getDirty:v,_updateValid:X,_removeUnmounted:fe,_updateFieldArray:z,_getFieldArray:k,_subjects:b,_proxyFormState:A,get _fields(){return i},get _formValues(){return a},get _stateFlags(){return h},set _stateFlags(s){h=s},get _defaultValues(){return l},get _names(){return g},set _names(s){g=s},get _formState(){return t},set _formState(s){t=s},get _options(){return r},set _options(s){r=m(m({},r),s)}},trigger:te,register:Ee,handleSubmit:vt,watch:mt,setValue:R,getValues:de,reset:(s,u)=>_t(be(s)?s(a):s,u),resetField:bt,clearErrors:ht,unregister:xe,setError:gt,setFocus:(s,u={})=>{const n=d(i,s),c=n&&n._f;if(c){const y=c.refs?c.refs[0]:c.ref;y.focus&&(y.focus(),u.shouldSelect&&y.select())}},getFieldState:Ie}}function er(e={}){const r=G.useRef(),[t,i]=G.useState({isDirty:!1,isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:e.defaultValues});r.current||(r.current=j(m({},Zt(e)),{formState:t}));const l=r.current.control;return l._options=e,It({subject:l._subjects.state,callback:G.useCallback(a=>{Ut(a,l._proxyFormState,!0)&&(l._formState=m(m({},l._formState),a),i(m({},l._formState)))},[l])}),G.useEffect(()=>{l._stateFlags.mount||(l._proxyFormState.isValid&&l._updateValid(),l._stateFlags.mount=!0),l._stateFlags.watch&&(l._stateFlags.watch=!1,l._subjects.state.next({})),l._removeUnmounted()}),G.useEffect(()=>{t.submitCount&&l._focusError()},[l,t.submitCount]),r.current.formState=Pt(t,l),r.current}const ft=(e="",r,t)=>{var i;const l=t.options.reduce((a,h)=>{var g;const F=(g=r.options)==null?void 0:g.find(p=>p.option_id===h.id);return F?a==null?void 0:a.replace(`{{${h.title}}}`,F.value):a},e);return(i=l==null?void 0:l.replace("{{sku}}",r.sku))==null?void 0:i.replace("{{title}}",t.title)};var tr=Object.defineProperty,dt=Object.getOwnPropertySymbols,rr=Object.prototype.hasOwnProperty,sr=Object.prototype.propertyIsEnumerable,yt=(e,r,t)=>r in e?tr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,ur=(e,r)=>{for(var t in r||(r={}))rr.call(r,t)&&yt(e,t,r[t]);if(dt)for(var t of dt(r))sr.call(r,t)&&yt(e,t,r[t]);return e};const ir=({product:e,open:r,onClose:t,defaultTemplate:i})=>{const{mutateAsync:l}=Ot(e.id),[a,h]=Nt(!1),{formState:{isDirty:g},handleSubmit:F,reset:p,register:L,watch:A}=er({defaultValues:Ue(e)});Tt(()=>{p(Ue(e))},[e,p]);const b=()=>{p(Ue(e)),t()},P=A("fiscal_title_template",""),O=F(async U=>{h(!0),await l({fiscal_title_template:U.fiscal_title_template||null}),h(!1),t()});return D(me,{open:r,onOpenChange:b,modal:!0,children:B(me.Content,{children:[D(me.Header,{children:D(Ke,{variant:"primary",type:"submit",disabled:!g,isLoading:a,form:"fiscal-template-form",children:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438"})}),D(me.Body,{className:" p-4",children:B("form",{onSubmit:O,id:"fiscal-template-form",children:[B("div",{className:"mb-base",children:[B("h2",{className:"inter-large-semibold mb-2xsmall",children:["\u0428\u0430\u0431\u043B\u043E\u043D \u0434\u043B\u044F \u043F\u0440\u043E\u0434\u0443\u043A\u0442\u0443 ",`"${e.title}"`]}),B("p",{className:"inter-base-regular text-grey-50 mb-2",children:["\u0412\u043F\u0438\u0448\u0438 \u0448\u0430\u0431\u043B\u043E\u043D \u044F\u043A\u0438\u0439 \u0431\u0443\u0434\u0435 \u0432\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u043E\u0432\u0443\u0432\u0430\u0442\u0438\u0441\u044F \u0434\u043B\u044F \u0432\u0441\u0456\u0445 \u0432\u0430\u0440\u0456\u0430\u043D\u0442\u0456\u0432 \u0432\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u043E\u0432\u0443\u044E\u0447\u0438 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u0456 \u043E\u043F\u0446\u0456\u0457:"," ",D("span",{className:"font-bold",children:[{title:"title"},{title:"sku"},...e.options||[]].map(U=>`{{${U.title}}}`).join(", ")}),D("br",{}),i?B(ge,{children:["\u041F\u0440\u0438 \u0432\u0456\u0434\u0441\u0443\u0442\u043D\u043E\u0441\u0442\u0456 \u0448\u0430\u0431\u043B\u043E\u043D\u0443 \u0432\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u043E\u0432\u0443\u0432\u0430\u0442\u0438\u043C\u0435\u0442\u044C\u0441\u044F \u0441\u0442\u0430\u043D\u0434\u0430\u0440\u0442\u043D\u0438\u0439 \u0448\u0430\u0431\u043B\u043E\u043D: ",D("span",{className:"font-bold",children:i})]}):D(ge,{children:"\u041F\u0440\u0438 \u0432\u0456\u0434\u0441\u0443\u0442\u043D\u043E\u0441\u0442\u0456 \u0448\u0430\u0431\u043B\u043E\u043D\u0443 \u0432\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u043E\u0432\u0443\u0432\u0430\u0442\u0438\u043C\u0435\u0442\u044C\u0441\u044F \u043D\u0430\u0437\u0432\u0430 \u043F\u0440\u043E\u0434\u0443\u043A\u0442\u0443"})]})]}),D(xt,ur({placeholder:"\u0428\u0430\u0431\u043B\u043E\u043D"},L("fiscal_title_template"))),P&&B("div",{className:"mt-5",children:[D("h2",{className:"inter-large-semibold mb-2xsmall",children:"\u041F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u0456\u0439 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u0434 \u043D\u0430\u0437\u0432\u0438 \u0432\u0430\u0440\u0456\u0432\u043D\u0442\u0456\u0432 \u0432 \u0444\u0456\u0441\u043A\u0430\u043B\u044C\u043D\u043E\u043C\u0443 \u0447\u0435\u043A\u0443"}),e.variants.map(U=>D("div",{className:"inter-base-regular",children:ft(P,U,e)},U.id))]})]})})]})})},Ue=e=>({fiscal_title_template:e.fiscal_title_template||""}),lr=({product:e})=>{const{state:r,toggle:t,close:i}=Et(),{data:l}=Bt("/product-default-fiscal-title-template",["product-default-fiscal-title-template"]);return B(ge,{children:[B(kt,{title:"\u0424\u0456\u0441\u043A\u0430\u043B\u0456\u0437\u0430\u0446\u0456\u044F",children:[B(Vt,{level:"h1",className:"flex items-center justify-between gap-x-4 text-2xl font-semibold",children:[D("div",{children:"\u0424\u0456\u0441\u043A\u0430\u043B\u0456\u0437\u0430\u0446\u0456\u044F"}),B(ve,{children:[D(ve.Trigger,{asChild:!0,children:D(Ke,{variant:"secondary",format:"icon",children:D(St,{})})}),D(ve.Content,{children:B(ve.Item,{onClick:t,className:"gap-x-2",children:[D(Ct,{className:"text-ui-fg-subtle"}),"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438"]})})]})]}),D("div",{className:"mt-base w-full",children:e.fiscal_title_template||l!=null&&l.fiscal_title_template?B(ge,{children:[D("div",{className:"inter-base-semibold",children:e.fiscal_title_template?"\u0428\u0430\u0431\u043B\u043E\u043D":"\u0421\u0442\u0430\u043D\u0434\u0430\u0440\u0442\u043D\u0438\u0439 \u0448\u0430\u0431\u043B\u043E\u043D"}),D("div",{className:"inter-base-regular",children:e.fiscal_title_template||l.fiscal_title_template}),D("div",{className:"inter-base-semibold mt-3",children:"\u041D\u0430\u0437\u0432\u0438 \u0432\u0430\u0440\u0456\u0430\u043D\u0442\u0456\u0432"}),e.variants.map(a=>D("div",{className:"inter-base-regular",children:ft(e.fiscal_title_template||l.fiscal_title_template,a,e)},a.id))]}):D("div",{className:"inter-regular",children:"\u0429\u0435 \u043D\u0435\u043C\u0430\u0454 \u0448\u0430\u0431\u043B\u043E\u043D\u0443..."})})]}),D(ir,{product:e,defaultTemplate:l==null?void 0:l.fiscal_title_template,open:r,onClose:i})]})},nr={zone:"product.details.after"},ar={identifier:"medusa-payment-fondy",extensions:[{Component:lr,config:j(m({},nr),{type:"widget"})}]};export{ar as default};
